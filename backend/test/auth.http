### Test de endpoints de autenticación
### Cambia el puerto y la URL según tu configuración

@baseUrl = http://localhost:3000/api/v1
@contentType = application/json

### 1. Registro de un usuario de prueba (primer paso)
POST {{baseUrl}}/auth/signup
Content-Type: {{contentType}}

{
  "name": "Usuario Prueba",
  "username": "testuser3",
  "email": "test@example3.com",
  "password": "password123"
}

### 2. Login exitoso
# @name login
POST {{baseUrl}}/auth/login
Content-Type: {{contentType}}

{
  "username": "testuser",
  "password": "password123"
}

### Guardar el token de la cookie para usar en requests posteriores
@authToken = {{login.response.headers.Set-Cookie}}

### 3. Login con usuario inexistente
POST {{baseUrl}}/auth/login
Content-Type: {{contentType}}

{
  "username": "usuarioinexistente",
  "password": "password123"
}

### 4. Login con contraseña incorrecta
POST {{baseUrl}}/auth/login
Content-Type: {{contentType}}

{
  "username": "pablo",
  "password": "123456"
}

### 5. Login con campos faltantes
POST {{baseUrl}}/auth/login
Content-Type: {{contentType}}

{
  "username": "testuser"
  // Falta password
}

### 6. Obtener usuario actual (éxito)
# @name getCurrentUser
GET {{baseUrl}}/auth/me
Cookie: jwt-talentnest=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NTk2OTEzNzksInVzZXJJZCI6IjY4ZTE2YzliM2RmODYxYzI3MmE0MzRjMiJ9.FXodXi2RMdb1v_hszn8fIHhqHFWsZldDuiZM1I6B8UQ

### 7. Obtener usuario actual sin token (debe fallar)
GET {{baseUrl}}/auth/me

### 8. Obtener usuario actual con token inválido (debe fallar)
GET {{baseUrl}}/auth/me
Cookie: jwt-talentnest=token_invalido

### 9. Logout exitoso
# @name logout
POST {{baseUrl}}/auth/logout
Cookie: jwt-talentnest={{authToken}}

### 10. Verificar que el logout funcionó (intentar obtener usuario después de logout)
GET {{baseUrl}}/auth/me
Cookie: jwt-talentnest={{authToken}}

### 11. Flujo completo: Registro -> Login -> GetCurrentUser -> Logout

### 11.1 Registrar nuevo usuario
# @name registerNewUser
POST {{baseUrl}}/auth/signup
Content-Type: {{contentType}}

{
  "name": "Nuevo Usuario",
  "username": "newuser",
  "email": "newuser@example.com",
  "password": "newpassword123"
}

### 11.2 Login con el nuevo usuario
# @name loginNewUser
POST {{baseUrl}}/auth/login
Content-Type: {{contentType}}

{
  "username": "newuser",
  "password": "newpassword123"
}

### Guardar el token del nuevo usuario
@newUserToken = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NTgzMTg4NzAsInVzZXJJZCI6IjY4Y2EyODgxYTllMDY2MmUyMTUxZDlkNyJ9.caV6eynKWIn-UVwxzZ1VxBe0NmeiEi0o4OFNsjiiK10"

### 11.3 Obtener información del nuevo usuario
GET {{baseUrl}}/auth/me
Cookie: jwt-talentnest={{newUserToken}}

### 11.4 Logout del nuevo usuario
POST {{baseUrl}}/auth/logout
Cookie: jwt-talentnest={{newUserToken}}
